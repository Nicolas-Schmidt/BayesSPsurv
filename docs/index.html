<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bayesian Spatial Split Population Survival Model • BayesSPsurv</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Bayesian Spatial Split Population Survival Model">
<meta property="og:description" content="Parametric spatial split-population (SP) survival models for clustered 
    event processes. The models account for structural and spatial heterogeneity among 
    “at risk” and “immune” populations, and incorporate time-varying covariates. 
    This package currently implements Weibull, Exponential and Log-logistic forms for 
    the duration component. It also includes functions for a series of diagnostic 
    tests and plots to easily visualize spatial autocorrelation, convergence, and spatial effects. Users can 
    create their own spatial weights matrix based on their units and adjacencies of 
    interest, making the use of these models flexible and broadly applicable to a 
    variety of research areas. Joo et al. (2020) &lt;https://github.com/Nicolas-Schmidt/BayesSPsurv/blob/master/man/figures/SPcure.pdf&gt; describe 
    the estimators included in this package. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">BayesSPsurv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Nicolas-Schmidt/BayesSPsurv/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="bayesspsurv" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#bayesspsurv" class="anchor"></a>BayesSPsurv</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<div id="description" class="section level3">
<h3 class="hasAnchor">
<a href="#description" class="anchor"></a>Description</h3>
<p>Parametric spatial split-population (SP) survival models for clustered event processes. The models account for both structural and spatial heterogeneity among “at risk” and “immune” populations, and incorporates time-varying covariates. This package currently implements Weibull, Exponential and Log-logistic forms for the duration component, and includes functions for a series of diagnostic tests and plots to easily visualize autocorrelation, convergence and spatial effects. The user can also create their own spatial weights matrix based on their units and adjacencies of interest, making the use of these models flexible and broadly applicable to a variety of research areas.</p>
</div>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>The latest version of the package (<code>0.1.1</code>) is available on <a href="https://cran.r-project.org/web/packages/BayesSPsurv/index.html">CRAN R</a>:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BayesSPsurv"</span>)</pre></div>
<p>To install the development version from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="st">"remotes"</span>)) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"remotes"</span>)
<span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"Nicolas-Schmidt/BayesSPsurv"</span>)</pre></div>
</div>
<div id="functions" class="section level3">
<h3 class="hasAnchor">
<a href="#functions" class="anchor"></a>Functions</h3>
<table class="table">
<colgroup>
<col width="12%">
<col width="87%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>spatialSPsurv</code></td>
<td>Markov Chain Monte Carlo (MCMC) to run time-varying Bayesian split population survival model with spatial frailties.</td>
</tr>
<tr class="even">
<td><code>exchangeSPsurv</code></td>
<td>Markov Chain Monte Carlo (MCMC) to run Bayesian split population survival model with exchangeable frailties.</td>
</tr>
<tr class="odd">
<td><code>pooledSPsurv</code></td>
<td>Markov Chain Monte Carlo (MCMC) to run Bayesian split population survival model with no frailties.</td>
</tr>
<tr class="even">
<td><code>plot_JointCount</code></td>
<td>Conducts Join Count tests to assess spatial clustering or dispersion of categorical variables in the data.</td>
</tr>
<tr class="odd">
<td><code>plot_Moran.I</code></td>
<td>Implements Global Moran I test to evaluate spatial autocorrelation in units’ risk propensity in the data.</td>
</tr>
<tr class="even">
<td><code>summary</code></td>
<td>Returns a summary of exchangeSPsurv, pooledSPsurv or spatialSPsurv object via <code><a href="https://rdrr.io/pkg/coda/man/summary.mcmc.html">coda::summary.mcmc</a></code>.</td>
</tr>
<tr class="odd">
<td><code>spatial_SA</code></td>
<td>Generates a spatial weights matrix with units and adjacencies defined by the user.</td>
</tr>
<tr class="even">
<td><code>SPstats</code></td>
<td>A function to calculate the deviance information criterion (DIC) and Log-likelihood for fitted model oupUts.</td>
</tr>
</tbody>
</table>
</div>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
</div>
<div id="data" class="section level3">
<h3 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h3>
<p>We illustrate the functionality of <code>BayesSPsurv</code> using data from Walter</p>
<p>(2015) that is included and described in the package.</p>
</div>
<div id="bayesian-spatial-split-population-sp-survival-model" class="section level3">
<h3 class="hasAnchor">
<a href="#bayesian-spatial-split-population-sp-survival-model" class="anchor"></a>Bayesian Spatial Split-Population (SP) Survival Model</h3>
<p><code>spatialSPsurv</code> estimates the Bayesian Spatial split-population survival (cure) model, which includes not only time-varying covariates but also spatially autocorrelated frailties in the model’s split and survival stage. To allow for easy replication, the examples below run a low number of iterations (N).</p>
<p><code>spatialSPsurv</code> Weibull model with N = 15,000 is <a href="https://github.com/Nicolas-Schmidt/BayesSPsurv/tree/master/data-raw">here</a>.</p>
<p><code>spatialSPsurv</code> Log-Logistic model with N = 15,000 is <a href="https://github.com/Nicolas-Schmidt/BayesSPsurv/tree/master/data-raw/data-raw-loglog">here</a>.</p>
<div class="sourceCode" id="cb3"><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">BayesSPsurv</span>)

<span class="co">## Data</span>
<span class="no">walter</span> <span class="kw">&lt;-</span> <span class="kw pkg">spduration</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/spduration/man/add_duration.html">add_duration</a></span>(<span class="no">Walter_2015_JCR</span>,<span class="st">"renewed_war"</span>,
                                   <span class="kw">unitID</span> <span class="kw">=</span> <span class="st">"ccode"</span>, <span class="kw">tID</span> <span class="kw">=</span> <span class="st">"year"</span>,
                                   <span class="kw">freq</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">ongoing</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span>
<span class="co">#&gt;   method            from</span>
<span class="co">#&gt;   as.zoo.data.frame zoo</span>
<span class="no">walter</span> <span class="kw">&lt;-</span> <span class="kw pkg">BayesSPsurv</span><span class="kw ns">::</span><span class="fu"><a href="reference/spatial_SA.html">spatial_SA</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">walter</span>, <span class="kw">var_ccode</span> <span class="kw">=</span> <span class="st">"ccode"</span>, <span class="kw">threshold</span> <span class="kw">=</span> <span class="fl">800L</span>)


<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123456</span>)

<span class="no">model</span> <span class="kw">&lt;-</span>
    <span class="fu"><a href="reference/spatialSPsurv.html">spatialSPsurv</a></span>(
        <span class="kw">duration</span> <span class="kw">=</span> <span class="no">duration</span> ~ <span class="no">fhcompor1</span> + <span class="no">lgdpl</span> + <span class="no">comprehensive</span> + <span class="no">victory</span> +
                              <span class="no">instabl</span> + <span class="no">intensityln</span> + <span class="no">ethfrac</span> + <span class="no">unpko</span>,
        <span class="kw">immune</span>   <span class="kw">=</span> <span class="no">cured</span> ~ <span class="no">fhcompor1</span> + <span class="no">lgdpl</span> + <span class="no">victory</span>,
        <span class="kw">Y0</span>       <span class="kw">=</span> <span class="st">'t.0'</span>,
        <span class="kw">LY</span>       <span class="kw">=</span> <span class="st">'lastyear'</span>,
        <span class="kw">S</span>        <span class="kw">=</span> <span class="st">'sp_id'</span> ,
        <span class="kw">data</span>     <span class="kw">=</span> <span class="no">walter</span><span class="kw">[[</span><span class="fl">1</span>]],
        <span class="kw">N</span>        <span class="kw">=</span> <span class="fl">500</span>,
        <span class="kw">burn</span>     <span class="kw">=</span> <span class="fl">10</span>,
        <span class="kw">thin</span>     <span class="kw">=</span> <span class="fl">10</span>,
        <span class="kw">w</span>        <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>),
        <span class="kw">m</span>        <span class="kw">=</span> <span class="fl">10</span>,
        <span class="kw">form</span>     <span class="kw">=</span> <span class="st">"Weibull"</span>,
        <span class="kw">prop.var</span> <span class="kw">=</span> <span class="fl">1e-05</span>,
        <span class="kw">A</span>        <span class="kw">=</span> <span class="no">walter</span><span class="kw">[[</span><span class="fl">2</span>]]
    )

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">model</span>)
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; spatialSPsurv(duration = duration ~ fhcompor1 + lgdpl + comprehensive + </span>
<span class="co">#&gt;     victory + instabl + intensityln + ethfrac + unpko, immune = cured ~ </span>
<span class="co">#&gt;     fhcompor1 + lgdpl + victory, Y0 = "t.0", LY = "lastyear", </span>
<span class="co">#&gt;     S = "sp_id", A = walter[[2]], data = walter[[1]], N = 500, </span>
<span class="co">#&gt;     burn = 10, thin = 10, w = c(1, 1, 1), m = 10, form = "Weibull", </span>
<span class="co">#&gt;     prop.var = 1e-05)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iterations = 1:49</span>
<span class="co">#&gt; Thinning interval = 1 </span>
<span class="co">#&gt; Number of chains = 1 </span>
<span class="co">#&gt; Sample size per chain = 49 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Empirical mean and standard deviation for each variable,</span>
<span class="co">#&gt; plus standard error of the mean:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Duration equation: </span>
<span class="co">#&gt;                      Mean         SD   Naive SE Time-series SE</span>
<span class="co">#&gt; (Intercept)    1.00814151 1.08126022 0.15446575     0.43017597</span>
<span class="co">#&gt; fhcompor1     -0.86040095 0.51570840 0.07367263     0.09154776</span>
<span class="co">#&gt; lgdpl          0.01516985 0.11875675 0.01696525     0.05333867</span>
<span class="co">#&gt; comprehensive -0.75590604 0.31156314 0.04450902     0.03266632</span>
<span class="co">#&gt; victory        0.47751228 0.37117992 0.05302570     0.02824285</span>
<span class="co">#&gt; instabl        0.74508684 0.47644646 0.06806378     0.06806378</span>
<span class="co">#&gt; intensityln    0.13956073 0.09491131 0.01355876     0.02921604</span>
<span class="co">#&gt; ethfrac        0.10052477 0.52692819 0.07527546     0.07527546</span>
<span class="co">#&gt; unpko          0.67711562 0.65094311 0.09299187     0.07259810</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Inmune equation: </span>
<span class="co">#&gt;                  Mean       SD  Naive SE Time-series SE</span>
<span class="co">#&gt; (Intercept) -2.224744 4.336817 0.6195454      1.1667720</span>
<span class="co">#&gt; fhcompor1    1.250456 3.846270 0.5494671      0.8986669</span>
<span class="co">#&gt; lgdpl       -2.313382 2.307048 0.3295783      0.3295783</span>
<span class="co">#&gt; victory      1.689145 3.135734 0.4479620      0.6556410</span>

<span class="fu"><a href="reference/SPstats.html">SPstats</a></span>(<span class="no">model</span>)
<span class="co">#&gt; $DIC</span>
<span class="co">#&gt; [1] -7501.048</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Loglik</span>
<span class="co">#&gt; [1] 23338.27</span>

<span class="co"># ~~~~~~~~~~~~~~~</span>
<span class="co"># Choropleth Map</span>
<span class="co"># ~~~~~~~~~~~~~~~</span>

<span class="no">spw</span>   <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">model</span>$<span class="no">W</span>, <span class="fl">2</span>, <span class="no">mean</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">model</span>$<span class="no">W</span>))
<span class="no">ccode</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">model</span>$<span class="no">W</span>)
<span class="no">ISO3</span>  <span class="kw">&lt;-</span> <span class="kw pkg">countrycode</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/countrycode/man/countrycode.html">countrycode</a></span>(<span class="no">ccode</span>,<span class="st">'gwn'</span>,<span class="st">'iso3c'</span>)
<span class="no">spw</span>   <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">ccode</span> <span class="kw">=</span> <span class="no">ccode</span>, <span class="kw">ISO3</span> <span class="kw">=</span> <span class="no">ISO3</span>, <span class="kw">spw</span> <span class="kw">=</span> <span class="no">spw</span>)
<span class="no">map</span>   <span class="kw">&lt;-</span> <span class="kw pkg">rworldmap</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/rworldmap/man/joinCountryData2Map.html">joinCountryData2Map</a></span>(<span class="no">spw</span>, <span class="kw">joinCode</span> <span class="kw">=</span> <span class="st">"ISO3"</span>, <span class="kw">nameJoinColumn</span> <span class="kw">=</span> <span class="st">"ISO3"</span>)
<span class="co">#&gt; 46 codes from your data successfully matched countries in the map</span>
<span class="co">#&gt; 0 codes from your data failed to match with a country code in the map</span>
<span class="co">#&gt; 197 codes from the map weren't represented in your data</span>
<span class="kw pkg">rworldmap</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/rworldmap/man/mapCountryData.html">mapCountryData</a></span>(<span class="no">map</span>, <span class="kw">nameColumnToPlot</span> <span class="kw">=</span> <span class="st">'spw'</span>)</pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
</div>
<div id="bayesian-exchangeable-split-population-sp-survival-model" class="section level3">
<h3 class="hasAnchor">
<a href="#bayesian-exchangeable-split-population-sp-survival-model" class="anchor"></a>Bayesian Exchangeable Split-Population (SP) Survival Model</h3>
<p>This model includes nonspatial unit-specific i.i.d frailties in the model’s split-stage (Vi) and survival stage (Wi) as well as time-varying covariates in each of these two stages.</p>
<p><code>exchangeSPsurv</code> Weibull model with N = 15,000 is <a href="https://github.com/Nicolas-Schmidt/BayesSPsurv/tree/master/data-raw">here</a>.</p>
<p><code>exchangeSPsurv</code> Log-Logistic model with N = 15,000 is <a href="https://github.com/Nicolas-Schmidt/BayesSPsurv/tree/master/data-raw/data-raw-loglog">here</a>.</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">walter</span> <span class="kw">&lt;-</span> <span class="kw pkg">spduration</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/spduration/man/add_duration.html">add_duration</a></span>(<span class="no">Walter_2015_JCR</span>,<span class="st">"renewed_war"</span>,
                                   <span class="kw">unitID</span> <span class="kw">=</span> <span class="st">"ccode"</span>, <span class="kw">tID</span> <span class="kw">=</span> <span class="st">"year"</span>,
                                   <span class="kw">freq</span> <span class="kw">=</span> <span class="st">"year"</span>, <span class="kw">ongoing</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="no">walter</span>$<span class="no">S</span>     <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">walter</span>$<span class="no">ccode</span>)), <span class="kw">times</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rle.html">rle</a></span>(<span class="no">walter</span>$<span class="no">ccode</span>)$<span class="no">lengths</span>)
<span class="no">country</span> <span class="kw">&lt;-</span> <span class="kw pkg">countrycode</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/countrycode/man/countrycode.html">countrycode</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">walter</span>$<span class="no">ccode</span>),<span class="st">'gwn'</span>,<span class="st">'iso3c'</span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123456</span>)

<span class="no">model</span> <span class="kw">&lt;-</span>
    <span class="fu"><a href="reference/exchangeSPsurv.html">exchangeSPsurv</a></span>(
        <span class="kw">duration</span> <span class="kw">=</span> <span class="no">duration</span> ~ <span class="no">fhcompor1</span> + <span class="no">lgdpl</span> + <span class="no">comprehensive</span> + <span class="no">victory</span> +
            <span class="no">instabl</span> + <span class="no">intensityln</span> + <span class="no">ethfrac</span> + <span class="no">unpko</span>,
        <span class="kw">immune</span>   <span class="kw">=</span> <span class="no">cured</span> ~ <span class="no">fhcompor1</span> + <span class="no">lgdpl</span> + <span class="no">victory</span>,
        <span class="kw">Y0</span>       <span class="kw">=</span> <span class="st">'t.0'</span>,
        <span class="kw">LY</span>       <span class="kw">=</span> <span class="st">'lastyear'</span>,
        <span class="kw">S</span>        <span class="kw">=</span> <span class="st">'S'</span> ,
        <span class="kw">data</span>     <span class="kw">=</span> <span class="no">walter</span>,
        <span class="kw">N</span>        <span class="kw">=</span> <span class="fl">500</span>,
        <span class="kw">burn</span>     <span class="kw">=</span> <span class="fl">10</span>,
        <span class="kw">thin</span>     <span class="kw">=</span> <span class="fl">10</span>,
        <span class="kw">w</span>        <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>),
        <span class="kw">m</span>        <span class="kw">=</span> <span class="fl">10</span>,
        <span class="kw">form</span>     <span class="kw">=</span> <span class="st">"loglog"</span>,
        <span class="kw">prop.var</span> <span class="kw">=</span> <span class="fl">1e-05</span>,
        <span class="kw">id_WV</span>    <span class="kw">=</span> <span class="no">country</span>
    )


<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="no">w_country</span> <span class="kw">&lt;-</span> <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">model</span>$<span class="no">W</span>), <span class="kw">cols</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">model</span>$<span class="no">W</span>))

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">w_country</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">name</span>), <span class="no">value</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">median</span>), <span class="kw">y</span> <span class="kw">=</span>  <span class="no">value</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="st">'gray'</span>) +  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>() + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">""</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">""</span>)</pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
</div>
<div id="bayesian-pooled-split-population-sp-survival-model" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-pooled-split-population-sp-survival-model" class="anchor"></a>Bayesian Pooled Split-Population (SP) Survival Model</h2>
<p>Bayesian SP survical model without unit-specific i.i.d frailties.</p>
<p><code>pooledSPsurv</code> Weibull model with N = 15,000 is <a href="https://github.com/Nicolas-Schmidt/BayesSPsurv/tree/master/data-raw">here</a>.</p>
<p><code>pooledSPsurv</code> Log-Logistic model with N = 15,000 is <a href="https://github.com/Nicolas-Schmidt/BayesSPsurv/tree/master/data-raw/data-raw-loglog">here</a>.</p>
<div class="sourceCode" id="cb5"><pre class="r">

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123456</span>)

<span class="no">model</span> <span class="kw">&lt;-</span>
     <span class="fu"><a href="reference/pooledSPsurv.html">pooledSPsurv</a></span>(
         <span class="kw">duration</span> <span class="kw">=</span> <span class="no">duration</span> ~ <span class="no">fhcompor1</span> + <span class="no">lgdpl</span> + <span class="no">comprehensive</span> + <span class="no">victory</span> +
             <span class="no">instabl</span> + <span class="no">intensityln</span> + <span class="no">ethfrac</span> + <span class="no">unpko</span>,
         <span class="kw">immune</span>   <span class="kw">=</span> <span class="no">cured</span> ~ <span class="no">fhcompor1</span> + <span class="no">lgdpl</span> + <span class="no">victory</span>,
         <span class="kw">Y0</span>       <span class="kw">=</span> <span class="st">'t.0'</span>,
         <span class="kw">LY</span>       <span class="kw">=</span> <span class="st">'lastyear'</span>,
         <span class="kw">data</span>     <span class="kw">=</span> <span class="no">walter</span>,
         <span class="kw">N</span>        <span class="kw">=</span> <span class="fl">500</span>,
         <span class="kw">burn</span>     <span class="kw">=</span> <span class="fl">10</span>,
         <span class="kw">thin</span>     <span class="kw">=</span> <span class="fl">10</span>,
         <span class="kw">w</span>        <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>),
         <span class="kw">m</span>        <span class="kw">=</span> <span class="fl">10</span>,
         <span class="kw">form</span>     <span class="kw">=</span> <span class="st">"Weibull"</span>
     )

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">model</span>)
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; pooledSPsurv(duration = duration ~ fhcompor1 + lgdpl + comprehensive + </span>
<span class="co">#&gt;     victory + instabl + intensityln + ethfrac + unpko, immune = cured ~ </span>
<span class="co">#&gt;     fhcompor1 + lgdpl + victory, Y0 = "t.0", LY = "lastyear", </span>
<span class="co">#&gt;     data = walter, N = 500, burn = 10, thin = 10, w = c(1, 1, </span>
<span class="co">#&gt;         1), m = 10, form = "Weibull")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iterations = 1:49</span>
<span class="co">#&gt; Thinning interval = 1 </span>
<span class="co">#&gt; Number of chains = 1 </span>
<span class="co">#&gt; Sample size per chain = 49 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Empirical mean and standard deviation for each variable,</span>
<span class="co">#&gt; plus standard error of the mean:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Duration equation: </span>
<span class="co">#&gt;                     Mean         SD   Naive SE Time-series SE</span>
<span class="co">#&gt; (Intercept)    2.3748909 1.38333158 0.19761880     0.64033808</span>
<span class="co">#&gt; fhcompor1     -0.9225435 0.62636551 0.08948079     0.13530712</span>
<span class="co">#&gt; lgdpl         -0.1006686 0.12871863 0.01838838     0.05205719</span>
<span class="co">#&gt; comprehensive -0.8376250 0.40244531 0.05749219     0.05749219</span>
<span class="co">#&gt; victory        0.3702996 0.44200695 0.06314385     0.06314385</span>
<span class="co">#&gt; instabl        0.8792065 0.55504640 0.07929234     0.07929234</span>
<span class="co">#&gt; intensityln    0.1185066 0.09089489 0.01298498     0.02403753</span>
<span class="co">#&gt; ethfrac       -0.3734596 0.71246591 0.10178084     0.13237277</span>
<span class="co">#&gt; unpko          0.5947845 0.60326265 0.08618038     0.08618038</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Inmune equation: </span>
<span class="co">#&gt;                    Mean       SD  Naive SE Time-series SE</span>
<span class="co">#&gt; (Intercept)  0.01876845 2.163802 0.3091146      0.4111774</span>
<span class="co">#&gt; fhcompor1    1.25950280 3.002383 0.4289118      0.6366892</span>
<span class="co">#&gt; lgdpl       -1.86099795 1.670992 0.2387131      0.2986771</span>
<span class="co">#&gt; victory     -0.24415725 2.435839 0.3479770      0.3479770</span></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=BayesSPsurv">https://​cloud.r-project.org/​package=BayesSPsurv</a>
</li>
<li>Browse source code at <br><a href="https://github.com/Nicolas-Schmidt/BayesSPsurv/">https://​github.com/​Nicolas-Schmidt/​BayesSPsurv/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/Nicolas-Schmidt/BayesSPsurv/issues">https://​github.com/​Nicolas-Schmidt/​BayesSPsurv/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Brandon L. Bolte <br><small class="roles"> Author </small>  </li>
<li>Nicolas Schmidt <br><small class="roles"> Author, maintainer </small>  </li>
<li>Sergio Bejar <br><small class="roles"> Author </small>  </li>
<li>Bumba Mukherjee <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=BayesSPsurv"><img src="https://www.r-pkg.org/badges/version/BayesMFSurv" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://github.com/Nicolas-Schmidt/BayesSPsurv/actions"><img src="https://github.com/Nicolas-Schmidt/spatialSPsurv/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active â€“ The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#stable"><img src="https://img.shields.io/badge/lifecycle-stable-green.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://github.com/Nicolas-Schmidt/BayesSPsurv"><img src="https://img.shields.io/badge/devel%20version-0.1.2-blue.svg"></a></li>
<li><a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Brandon L. Bolte, Nicolas Schmidt, Sergio Bejar, Bumba Mukherjee.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
